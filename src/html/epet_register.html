<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />   
    <title>新用户注册</title>
    <link rel="stylesheet" type="text/css" href="./../css/register.css" />
    <link rel="stylesheet" type="text/css" href="./../css/style.css" />
    <link rel="stylesheet" type="text/css" href="./../css/slide-unlock.css" />
    <script src="./../lib/jquery-3.2.1.js"></script>
</head>
<body>
    <!-- 顶部 -->
    <div class="overflow bgwhite Registertopmain">
        <div class="overflow w1100 ct Registertop">
            <div class="overflow fl">
                <a href="http://www.epet.com/" target="_blank"><img src="./../img/register_img/cart-logo.png"></a>
                <span><img src="./../img/register_img/welcome2register.jpg"></span>
            </div>
            <div class="overflow fr Logonfr">
                <span class="c666 ft14">已有账号？</span>
                <a href="./login.html" target="_blank" class="ft16 Logon">登录</a>
            </div>
        </div>
    </div>
    <!-- 注册表单 -->

    <div class=" bgwhite Registertopmain">
        <form method="post" action="" id="regform">
            <input type="hidden" name="do" value="postSubmit">
            <input type="hidden" name="inajax" value="1">
            <input type="hidden" name="formhash" value="f2919f1dbc">
            <input type="hidden" name="postsubmit" value="true">
            <input type="hidden" name="referer" id="referer" value="">
            <div class="overflow w1100 ct Registercontent">
                <div class=" ct Registertext" id="register">
                <!--  -->
<!--                     <div class="rela mb Registerinput">
                        <span class="ft16 textright inblock">手机号：</span>
                        <input tabindex="1" type="text" name="phone" id="phone" placeholder="请输入手机号码" class="phonenumbererror">
                        <div class="abs Registerok " id="phonemsg_img" style="display: none;">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>
                        <div class="abs Registererror" id="phonemsg_div" style="width: 150px; display: block;">
                            <span id="phonemsg" class="onError">请输入11位电话号码</span>
                        </div>
                    </div> -->
<!--                     <div class="overflow mb Registerinput Yanzhengma rela" style="overflow: visible;">
                        <span class="ft16 textright inblock">验证码：</span>
                        <input tabindex="2" type="text" name="varify" id="regvairfy" placeholder="请输入图片内容" class="phonenumbererror">
                        <div class="overflow inblock Registeryanzheng rela">
                            <img style="position: absolute;top:-7px;left:-2px;" src="" id="varifyimgreg" class="codevar" title="看不清?换一张" align="absbottom">
                            <a href="javascript:void(0);" style="position: absolute;right:9px;" class="inblock ft14 ftc c999" onclick="freshcode($(&#39;#varifyimgreg&#39;),105,60,&#39;register_seccode&#39;)"><img id="xuanzhuan" src="./../img/register_img/renfren_03.jpg" height="15" width="14"> 换一换</a>
                        </div>
                        <div class="abs Registerok" style="display: none;" id="varify_img">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>
                        <div class="abs Registererror" name="varify_msg" id="varify_msg_div" style="width: 150px;">
                            <span id="varify_msg" class="onShow">请输入图片验证码</span>
                        </div>
                    </div>
                    <script src="./../js/epet_register/v_f.js"></script>
                    <script type="text/javascript">
                        var verifyCode = new GVerify("varifyimgreg");
                        document.getElementById("varifyimgreg").onclick = function(){
                            var res = verifyCode.validate(document.getElementById("regvairfy").value);
                            if(res){
                                // varify_msg_div.style.display = 'none';
                                // nickname_img.style.display = 'block';
                                alert("验证正确");
                            }else{
                                // varify_msg_div.style.display = 'block';
                                // nickname_msg.innerHTML ='请输入图片验证码';
                                alert("验证不正确");
                            }
                        }
                    </script> -->
<!--                     <div class="overflow mb Registerinput Yanzhengma Duanxinyanzhengma rela" style="overflow: visible;">
                        <span class="ft16 textright inblock">短信验证码：</span>
                        <input tabindex="3" type="text" name="msgcode" id="regphonecode" placeholder="验证码">
                        <a href="javascript:void(0);" onclick="send_Phonecode(&#39;register&#39;)" id="phonecodebtnregister" class="overflow inblock Registeryanzheng ft14 c999 ftc ">
                            <span> 获取验证码 </span>
                        </a>
                        <div class="abs Registerok" style="display: none;" id="msgcode_img">
                            <img src="./新用户注册_files/ok_03.jpg">
                        </div>
                        <div class="abs Registererror" id="msgcode_msg_div" style="width: 150px;display: none;">
                            <span id="msgcode_msg" class="onShow"></span>
                        </div>
                    </div> -->
                    <!-- 验证用户名 -->
                    <div class="rela mb Registerinput">
                        <span class="ft16 textright inblock">用户名：</span>
                        <input tabindex="4" type="text" name="nickname" id="nickname" maxlength="20" placeholder="用户名">
                        <div class="abs Registerok" style="display: none;" id="nickname_img">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>
                        <div class="abs Registererror" id="nickname_msg_div" style="width: 150px;display: none;">
                            <span id="nickname_msg" class="onShow"></span>
                        </div>
                    </div>
                    <!-- 验证密码 -->

                    <div class=" mb Registerinput rela">
                        <span class="ft16 textright inblock"> 密码：</span>
                        <input tabindex="5" type="password" autocomplete="new-password" class="logpass" name="password" id="passwordr" maxlength="20" onkeyup="getlevel()" placeholder="密码（8-20位，区分大小写）">
                        <div class="abs Registerok" style="display: none;" id="password_img">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>
                        <div class="abs Registererror" style="width:150px;display: none;" id="password_msg_div">
                            <span id="password_msg" class="onShow">请输入密码</span>
                        </div>
                    </div>

                    <!-- 密码强度 -->
                    <div class="overflow mb Pwdqiangdu" style="display: none;" id="qiangdu">
                        <span class="block ftc fl " id="leval0">弱</span>
                        <span class="block ftc fl" id="leval1">中</span>
                        <span class="block ftc fl" id="leval2">牛逼</span>
                    </div>
                    <!-- 确认密码 -->
                    <div class="mb Registerinput rela">
                        <span class="ft16 textright inblock"> 确认密码：</span>
                        <input tabindex="6" type="password" autocomplete="new-password" class="logpass" maxlength="20" name="passwordag" id="passwordag" placeholder="确认密码">
                        <div class="abs Registerok" style="display: none;" id="passwordag_img">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>
                        <div class="abs Registererror" id="passwordag_msg_div" style="width: 150px;display: none;">
                            <span id="passwordag_msg" class="onShow">请输入确认密码</span>
                        </div>
                    </div>

                    <!-- 滑动验证 -->
                    <div id="v_f" class="mb Registerinput rela">
                        <span class="ft16 textright inblock"> 验证码：</span>
                        <div id="slider">
                            <div id="slider_bg" class=""></div>
                        
                            <span id="label">>></span> <span id="labelTip">拖动滑块验证</span> 
                        </div>
                        <div class="abs Registerok" style="display: none;" id="varify_img">
                            <img src="./../img/register_img/rg_ok_01.jpg">
                        </div>

                      <script>
                        $(function () {
                            var varify_img = document.getElementById('varify_img');
                            var slider = new SliderUnlock("#slider",{
                                    successLabelTip : "验证成功~"    
                                },function(){
                                    varify_img.style.display = 'block';
                                });
                            slider.init();
                        })
                    </script> 
                    </div>
                    <!-- 用户协议 -->
                    <div class="overflow mb Pwdqiangdu">
                        <input tabindex="7" type="checkbox" checked="checked" name="agrement">
                        <span class="Xieyi ft14">我已阅读并接受E宠<a href="http://www.epet.com/article37.html" target="_blank">《用户使用协议》</a></span>
                    </div>
                    <button class="inblock ct ftc ft20 cwhite  Otherregister" id="registerbtn" name="registerbtn" style="cursor: pointer;margin: 15px 0 50px 100px;" onclick="">立即注册</button>
                </div>
            </div>
        </form>
    </div>
    <!-- 底部 -->
    <div class="overflow bgwhite">
        <div class="overflow ct Registerfooter ftc">
            <a class="c999" href="http://www.epet.com/" target="_blank">E宠商城  |</a>
            <a class="c999" href="http://zs.epet.com/" target="_blank">知识  |</a>
            <a class="c999" href="http://www.epet.com/article/about.html" target="_blank">关于我们  |</a>
            <a class="c999" href="http://www.epet.com/article1643.html" target="_blank">联系我们 </a>
            <p class="c999 ftc">渝ICP备13005525号-2 &nbsp; 渝ICP备 10002905 &nbsp;增值电信业务经营许可证：渝B2-20140042 &nbsp; Copyright © 2007-2016 epet.com &nbsp;重庆易宠科技有限公司</p>
        </div>
    </div>
    
    <!-- 验证用户名是否存在 -->
    <!-- 先后顺序有问题bug -->
    <script>
        document.addEventListener("DOMContentLoaded",function(){
            /*
                验证用户名是否被占用
             */
            var nickname = document.querySelector('#nickname');
            var passwordr = document.querySelector('#passwordr');
            var nickname_msg = document.querySelector('#nickname_msg');
            var nickname_msg_div = document.querySelector('#nickname_msg_div');
            var nickname_img = document.querySelector('#nickname_img');
            var registerbtn = document.querySelector('#registerbtn');

            nickname.onblur = function(){
                var _nickname = nickname.value;

                // 1.创建一个异步请求对象
                var xhr = new XMLHttpRequest();

                // 4.处理数据
                xhr.onreadystatechange = function(){
                    if(xhr.readyState === 4){
                        var res = xhr.responseText;
                        console.log(res);
                        if(res === 'fail'){
                            nickname_msg_div.style.display = 'block';
                            nickname_msg.innerHTML = '用户名已被注册';
                        }else{
                            nickname_msg_div.style.display = 'none';
                            nickname_img.style.display = 'block';
                        }
                    }
                }

                xhr.open('get','http://localhost/gz1704/src/mysql/reg.php?nickname='+_nickname,true);
                xhr.send();
            }
        })
    </script>
    <script src="./../js/epet_register/qiangdu.js"></script>
    <script src="./../js/epet_register/verify.js"></script>
    <script src="./../lib/jquery-1.12.1.min.js"></script> 
    <script src="./../lib/jquery.slideunlock.js"></script> 
</body>
</html>